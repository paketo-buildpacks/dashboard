(this["webpackJsonppaketo-dashboard"]=this["webpackJsonppaketo-dashboard"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t){},,,,,,function(e,t){},,,function(e,t,n){e.exports=n(44)},,,,,function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(23),o=n.n(s);n(30),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(12),i=n(1),u=n(2),l=n(10),p=n(5),h=n(6),m=n(3),f=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t="";return t="/paketo-dashboard",r.a.createElement(m.b,{path:this.props.path,render:function(n){var a=n.location;return e.props.authenticated?e.props.children:r.a.createElement(m.a,{to:{pathname:"".concat(t,"/login"),state:{from:a}}})}})}}]),n}(r.a.Component),d=(n(36),n(37),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e="";return e="/paketo-dashboard",r.a.createElement("header",null,r.a.createElement("h1",null,r.a.createElement(c.b,{to:e},r.a.createElement("img",{src:"".concat(e,"/logo512.png"),className:"logo",alt:"logo"}),"Paketo Buildpacks")),r.a.createElement("div",{className:"navigation"}))}}]),n}(r.a.Component)),v=(n(38),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(i.a)(this,n);var r="/";r="/paketo-dashboard";var s=((a=t.call(this,e)).props.location.state||{from:{pathname:r}}).from;return a.state={token:"",from:s},a.handleChange=a.handleChange.bind(Object(l.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"handleChange",value:function(e){var t=e.currentTarget;this.setState({token:t.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.assignToken(this.state.token),this.props.history.replace(this.state.from)}},{key:"render",value:function(){return r.a.createElement("form",{className:"login",onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"token"},"GitHub Personal Access Token"),r.a.createElement("input",{type:"text",id:"token",value:this.state.token,onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Submit"}))}}]),n}(r.a.Component)),b=n(4),k=n.n(b),y=n(11),O=n(7),g=function(){function e(t){Object(i.a)(this,e),this.key=btoa(t.name),this.name=t.name,this.url=t.url,this.openIssuesCount=t.openIssuesCount}return Object(u.a)(e,[{key:"isEqualTo",value:function(e){return e.name===this.name&&e.url===this.url&&e.openIssuesCount===this.openIssuesCount}}]),e}(),j=(n(40),n(41),function e(t){Object(i.a)(this,e),this.number=t.number}),E=(n(16),function(){function e(t){Object(i.a)(this,e),this.storage=t.storage}return Object(u.a)(e,[{key:"do",value:function(){var e=Object(O.a)(k.a.mark((function e(t){var n,a,r,s,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage.getItem("token")||"",(a=t.path).startsWith("/")&&(a="https://api.github.com".concat(a)),e.next=5,fetch(a,{method:t.method,headers:{Authorization:"Bearer ".concat(n)}});case 5:return r=e.sent,s=r.headers.get("Link"),e.next=9,r.json();case 9:return o=e.sent,e.abrupt("return",{data:o,headers:{link:s}});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),w=function(){function e(t){Object(i.a)(this,e),this.client=t.client}return Object(u.a)(e,[{key:"list",value:function(){var e=Object(O.a)(k.a.mark((function e(t){var n,a,r,s,o,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="/repos/".concat(t,"/issues"),a=[];case 2:if(!n){e.next=11;break}return e.next=5,this.client.do({method:"GET",path:n});case 5:r=e.sent,s=Object(y.a)(r.data);try{for(s.s();!(o=s.n()).done;)(c=o.value).pull_request||a.push(new j({number:c.number}))}catch(i){s.e(i)}finally{s.f()}n=((r.headers.link||"").match(/<([^>]+)>;\s*rel="next"/)||[])[1],e.next=2;break;case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),S=function(){function e(t){Object(i.a)(this,e),this.props=t}return Object(u.a)(e,[{key:"set",value:function(e,t){e=this._key(e),this.props.storage.setItem(e,JSON.stringify(t))}},{key:"get",value:function(e){e=this._key(e);var t=this.props.storage.getItem(e);return t?JSON.parse(t):{}}},{key:"_key",value:function(e){return e=e.replace(/^(\/)/,""),"/cache/".concat(e)}}]),e}(),x=n(13),C=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).cacheKey="/repos/".concat(e.repo.name,"/issues");var r=[],s=a.props.cache.get(a.cacheKey);if(s.issues)for(var o=0;o<s.issues.length;o++)r.push(new j(s.issues[o]));return a.state={issues:r},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.load()}},{key:"componentDidUpdate",value:function(e){this.props.repo.openIssuesCount!==e.repo.openIssuesCount&&this.load()}},{key:"load",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.list(this.props.repo.name);case 2:t=e.sent,this.props.cache.set(this.cacheKey,{issues:t}),this.setState({issues:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e="none",t=this.state.issues.length;return t>0&&(e="low"),t>3&&(e="medium"),t>6&&(e="high"),r.a.createElement("div",{className:"issue-count ".concat(e),"aria-label":"issue-count"},r.a.createElement(x.b,{size:16}),r.a.createElement("div",{className:"count"},t))}}]),n}(r.a.Component),q=(n(42),function e(t){Object(i.a)(this,e),this.number=t.number}),N=function(){function e(t){Object(i.a)(this,e),this.client=t.client}return Object(u.a)(e,[{key:"list",value:function(){var e=Object(O.a)(k.a.mark((function e(t){var n,a,r,s,o,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="/repos/".concat(t,"/pulls"),a=[];case 2:if(!n){e.next=11;break}return e.next=5,this.client.do({method:"GET",path:n});case 5:r=e.sent,s=Object(y.a)(r.data);try{for(s.s();!(o=s.n()).done;)c=o.value,a.push(new q({number:c.number}))}catch(i){s.e(i)}finally{s.f()}n=((r.headers.link||"").match(/<([^>]+)>;\s*rel="next"/)||[])[1],e.next=2;break;case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),I=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).cacheKey="/repos/".concat(e.repo.name,"/pull_requests");var r=[],s=a.props.cache.get(a.cacheKey);if(s.pull_requests)for(var o=0;o<s.pull_requests.length;o++)r.push(new q(s.pull_requests[o]));return a.state={pullRequests:r},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.load()}},{key:"componentDidUpdate",value:function(e){this.props.repo.openIssuesCount!==e.repo.openIssuesCount&&this.load()}},{key:"load",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.store.list(this.props.repo.name);case 2:t=e.sent,this.props.cache.set(this.cacheKey,{pull_requests:t}),this.setState({pullRequests:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e="none",t=this.state.pullRequests.length;return t>0&&(e="low"),t>3&&(e="medium"),t>6&&(e="high"),r.a.createElement("div",{className:"pull-request-count ".concat(e),"aria-label":"pull-request-count"},r.a.createElement(x.a,{size:16}),r.a.createElement("div",{className:"count"},t))}}]),n}(r.a.Component),_=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"shouldComponentUpdate",value:function(e){return!this.props.repo.isEqualTo(e.repo)}},{key:"render",value:function(){var e=this.props.repo.name.split("/"),t=e[0],n=e[1];return r.a.createElement("div",{className:"repo-item"},r.a.createElement("div",{className:"org"},t),r.a.createElement("a",{className:"repo",href:this.props.repo.url,target:"_blank",rel:"noopener noreferrer"},n),r.a.createElement("div",{className:"content"},r.a.createElement(C,{repo:this.props.repo,store:this.props.issueStore,cache:this.props.cache}),r.a.createElement(I,{repo:this.props.repo,store:this.props.pullRequestStore,cache:this.props.cache})))}}]),n}(r.a.Component),R=function(){function e(t){Object(i.a)(this,e),this.props=t}return Object(u.a)(e,[{key:"list",value:function(){var e=Object(O.a)(k.a.mark((function e(t){var n,a,r,s,o,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a="/orgs/".concat(t,"/repos");case 2:if(!a){e.next=11;break}return e.next=5,this.props.client.do({method:"GET",path:a});case 5:r=e.sent,s=Object(y.a)(r.data);try{for(s.s();!(o=s.n()).done;)c=o.value,n.push(new g({name:c.full_name,url:c.html_url,openIssuesCount:c.open_issues_count}))}catch(i){s.e(i)}finally{s.f()}a=((r.headers.link||"").match(/<([^>]+)>;\s*rel="next"/)||[])[1],e.next=2;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),T=(n(22),n(43),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).cacheKey="/repos";var r=[],s=a.props.cache.get(a.cacheKey);if(s.repos)for(var o=0;o<s.repos.length;o++)r.push(new g(s.repos[o]));return a.state={loading:0===r.length,repos:r},a.handleReload=a.handleReload.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.load(),this.interval=this.props.timer.setInterval(this.load.bind(this),9e5)}},{key:"componentWillUnmount",value:function(){this.props.timer.clearInterval(this.interval)}},{key:"handleReload",value:function(e){this.load()}},{key:"load",value:function(){var e=Object(O.a)(k.a.mark((function e(){var t,n,a,r,s,o,c,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.props.store.list("paketo-buildpacks"),this.props.store.list("paketo-community")]);case 2:t=e.sent,n=[],a=Object(y.a)(t);try{for(a.s();!(r=a.n()).done;){s=r.value,o=Object(y.a)(s);try{for(o.s();!(c=o.n()).done;)i=c.value,n.push(i)}catch(u){o.e(u)}finally{o.f()}}}catch(u){a.e(u)}finally{a.f()}n.sort((function(e,t){var n=e.name.toUpperCase(),a=t.name.toUpperCase();return n<a?-1:n>a?1:0})),this.props.cache.set(this.cacheKey,{repos:n}),this.setState({loading:!1,repos:n});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=r.a.createElement("div",{className:"loading"},"...");return this.state.loading||(t=this.state.repos.map((function(t){return r.a.createElement(_,{key:t.key,repo:t,issueStore:e.props.issueStore,pullRequestStore:e.props.pullRequestStore,cache:e.props.cache})}))),r.a.createElement("div",{className:"repo-list"},r.a.createElement("div",{className:"title"},r.a.createElement("h2",null,"Overview"),r.a.createElement("button",{onClick:this.handleReload},r.a.createElement(x.c,{size:16}))),r.a.createElement("div",{className:"list"},t))}}]),n}(r.a.Component)),K=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={authenticated:!!a.props.storage.getItem("token")},a.assignToken=a.assignToken.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"assignToken",value:function(e){this.props.storage.setItem("token",e),this.setState({authenticated:!!this.props.storage.getItem("token")})}},{key:"render",value:function(){var e=this,t="";return t="/paketo-dashboard",r.a.createElement("div",{className:"app"},r.a.createElement(d,null),r.a.createElement("section",{className:"body"},r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"".concat(t,"/login"),render:function(t){var n=t.history,a=t.location;return r.a.createElement(v,{assignToken:e.assignToken,history:n,location:a})}}),r.a.createElement(f,{path:"".concat(t,"/"),authenticated:this.state.authenticated},r.a.createElement(T,{store:this.props.repoStore,issueStore:this.props.issueStore,pullRequestStore:this.props.pullRequestStore,timer:this.props.timer,cache:this.props.cache})))))}}]),n}(r.a.Component),D=window.localStorage,U=window,z=new S({storage:D}),B=new E({storage:D}),G=new R({client:B}),J=new w({client:B}),W=new N({client:B});o.a.render(r.a.createElement(c.a,null,r.a.createElement(K,{repoStore:G,issueStore:J,pullRequestStore:W,timer:U,cache:z,storage:D})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[25,1,2]]]);
//# sourceMappingURL=main.6f124d2d.chunk.js.map